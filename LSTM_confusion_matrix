# ì„±ëŠ¥ í‰ê°€: ì˜ˆì¸¡ ì •í™•ë„ ë¶„ì„
from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, confusion_matrix, classification_report
import matplotlib.pyplot as plt
import seaborn as sns

# ëª¨ë¸ í‰ê°€ ëª¨ë“œ ì „í™˜
model.eval()

# ì˜ˆì¸¡ ê²°ê³¼ ì €ì¥ìš© ë¦¬ìŠ¤íŠ¸
y_true = []
y_pred = []

with torch.no_grad():
    for inputs, labels in val_loader:
        inputs, labels = inputs.to(device), labels.to(device)
        outputs = model(inputs)
        preds = torch.argmax(outputs, dim=1)

        y_true.extend(labels.cpu().numpy())
        y_pred.extend(preds.cpu().numpy())

# âœ… í‰ê°€ ì§€í‘œ ì¶œë ¥
print("ğŸ” Classification Report")
print(classification_report(y_true, y_pred, digits=4))

# âœ… í˜¼ë™ í–‰ë ¬ ì‹œê°í™”
cm = confusion_matrix(y_true, y_pred)
plt.figure(figsize=(5,4))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', xticklabels=['Pred 0', 'Pred 1'], yticklabels=['True 0', 'True 1'])
plt.xlabel("Predicted Label")
plt.ylabel("True Label")
plt.title("Confusion Matrix")
plt.tight_layout()
plt.show()
